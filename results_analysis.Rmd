---
title: "Results Analysis"
author: "Patrick Halbach, Johannes Nakayama"
date: "29 1 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

```

```{r}

results <- read_csv(file.path("simulation", "results.csv"))

results$ConfigAgentCount <- as.factor(results$ConfigAgentCount)
results$ConfigUnfriendThresh <- as.factor(results$ConfigUnfriendThresh)
results$ConfigAddfriendMethod <- factor(x = results$ConfigAddfriendMethod, levels = c("neighborsofneighbors", "hybrid", "random"))

results$Config
```


```{r}

results

results %>% 
  filter(BatchName == "Netsize") %>% 
  select(-c(BatchName, ConfigUnfriendThresh, ConfigAddfriendMethod)) %>% 
  group_by(ConfigAgentCount) %>% 
  summarise_all(mean) -> netsize_aggregates

results %>% 
  filter(BatchName == "Addfriends") %>% 
  select(-c(BatchName, ConfigUnfriendThresh, ConfigAgentCount)) %>% 
  group_by(ConfigAddfriendMethod) %>% 
  summarise_all(mean) -> addfriends_aggregates

results %>% 
  filter(BatchName == "Unfriend") %>% 
  select(-c(BatchName, ConfigAddfriendMethod, ConfigAgentCount)) %>% 
  group_by(ConfigUnfriendThresh) %>% 
  summarise_all(mean) -> unfriend_aggregates


as.integer(levels(factor(500)))
```

```{r netsize}




results %>% 
  filter(BatchName == "Netsize") %>% 
  select(ConfigAgentCount, OpChangeDeltaMean) %>% 
  ggplot(aes(x = ConfigAgentCount, y = OpChangeDeltaMean)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAgentCount)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Netsize") %>% 
  select(ConfigAgentCount, OutdegreeSD) %>% 
  ggplot(aes(x = ConfigAgentCount, y = OutdegreeSD)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAgentCount)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Netsize") %>% 
  select(ConfigAgentCount, OutdegreeMean) %>% 
  ggplot(aes(x = ConfigAgentCount, y = OutdegreeMean)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAgentCount)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Netsize") %>% 
  select(ConfigAgentCount, ConfigAgentCount, OutdegreeMax) %>% 
  mutate(OutdegreeMaxRel = OutdegreeMax/as.integer(levels(ConfigAgentCount))) %>% 
  ggplot(aes(x = ConfigAgentCount, y = OutdegreeMaxRel)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAgentCount)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Netsize") %>% 
  select(ConfigAgentCount, OutdegreeMean) %>% 
  ggplot(aes(x = ConfigAgentCount, y = OutdegreeMean)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAgentCount)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Netsize") %>% 
  select(ConfigAgentCount, IndegreeSD) %>% 
  ggplot(aes(x = ConfigAgentCount, y = IndegreeSD)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAgentCount)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Netsize") %>% 
  select(ConfigAgentCount, IndegreeMean) %>% 
  ggplot(aes(x = ConfigAgentCount, y = IndegreeMean)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAgentCount)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Netsize") %>% 
  select(ConfigAgentCount, Betweenness_centrality_mean) %>% 
  ggplot(aes(x = ConfigAgentCount, y = Betweenness_centrality_mean)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAgentCount)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Netsize") %>% 
  select(ConfigAgentCount, SupernodeCentrality) %>% 
  ggplot(aes(x = ConfigAgentCount, y = SupernodeCentrality)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAgentCount)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Netsize") %>% 
  select(ConfigAgentCount, ClustCoeff) %>% 
  ggplot(aes(x = ConfigAgentCount, y = ClustCoeff)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAgentCount)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Netsize") %>% 
  select(ConfigAgentCount, Densities) %>% 
  ggplot(aes(x = ConfigAgentCount, y = Densities)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAgentCount)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  # select(ConfigAgentCount, CommunityCount, ConnectedComponents) %>% 
  mutate(CommunityCountClean = CommunityCount - ConnectedComponents + 1) %>% 
  ggplot(aes(x = ConfigAgentCount, y = CommunityCountClean)) +
  facet_wrap(facets = BatchName) +
  geom_jitter(alpha = 0.3, width = 0.2, height = 0.05) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(
    alpha = 0.6, 
    lwd = 0.8, 
    aes(fill = ConfigAgentCount, color = ConfigAgentCount)
  ) +
  theme_bw() +
  theme(legend.position = "none") +
  labs(
    x = "Configuration", 
    y = "Number of Communities (Label Propagation)"
  )



```

```{r addfriends}

results %>% 
  filter(BatchName == "Addfriends") %>% 
  select(ConfigAddfriendMethod, OpChangeDeltaMean) %>% 
  ggplot(aes(x = ConfigAddfriendMethod, y = OpChangeDeltaMean)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAddfriendMethod)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Addfriends") %>% 
  select(ConfigAddfriendMethod, OutdegreeSD) %>% 
  ggplot(aes(x = ConfigAddfriendMethod, y = OutdegreeSD)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAddfriendMethod)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Addfriends") %>% 
  select(ConfigAddfriendMethod, OutdegreeMean) %>% 
  ggplot(aes(x = ConfigAddfriendMethod, y = OutdegreeMean)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAddfriendMethod)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Addfriends") %>% 
  select(ConfigAddfriendMethod, Densities) %>% 
  ggplot(aes(x = ConfigAddfriendMethod, y = Densities))  +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAddfriendMethod)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Addfriends") %>% 
  select(ConfigAddfriendMethod, IndegreeSD) %>% 
  ggplot(aes(x = ConfigAddfriendMethod, y = IndegreeSD)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAddfriendMethod)) +
  theme_bw() +
  theme(legend.position = "none")

results %>%
  filter(BatchName == "Addfriends") %>% 
  select(ConfigAddfriendMethod, IndegreeMean) %>% 
  ggplot(aes(x = ConfigAddfriendMethod, y = IndegreeMean)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAddfriendMethod)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Addfriends") %>% 
  select(ConfigAddfriendMethod, SupernodeCentrality) %>% 
  ggplot(aes(x = ConfigAddfriendMethod, y = SupernodeCentrality)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAddfriendMethod)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Addfriends") %>% 
  select(ConfigAddfriendMethod, SupernodeOpinion) %>% 
  ggplot(aes(x = ConfigAddfriendMethod, y = SupernodeOpinion)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAddfriendMethod)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Addfriends") %>% 
  select(ConfigAddfriendMethod, ClustCoeff) %>% 
  ggplot(aes(x = ConfigAddfriendMethod, y = ClustCoeff)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAddfriendMethod)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Addfriends") %>% 
  select(ConfigAddfriendMethod, CommunityCount, ConnectedComponents) %>%
  mutate(CommunityCountClean = CommunityCount - ConnectedComponents + 1) %>% 
  ggplot(aes(x = ConfigAddfriendMethod, y = CommunityCountClean)) +
  geom_jitter(alpha = 0.3, width = 0.2, height = 0.05) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAddfriendMethod)) +
  theme_bw() +
  theme(legend.position = "none") +
  labs(
    x = "Configuration", 
    y = "Number of Communities (Label Propagation)"
  )

levels(results$ConfigAddfriendMethod)[3]

library(Hmisc)

results %>% 
  # filter(BatchName == "Addfriends") %>% 
  select(ConfigAddfriendMethod, CommunityOpMeanSDs, OpChangeDeltaMean) %>%
  ggplot(aes(x = ConfigAddfriendMethod, y = CommunityOpMeanSDs)) +
  geom_jitter(alpha = 0.8, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAddfriendMethod)) +
  theme_bw() +
  scale_color_viridis_c() + 
  # theme(legend.position = "none") +
  NULL

```

```{r unfriend}

results %>% 
  filter(BatchName == "Unfriend") %>% 
  select(ConfigUnfriendThresh, OpChangeDeltaMean) %>% 
  ggplot(aes(x = ConfigUnfriendThresh, y = OpChangeDeltaMean)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigUnfriendThresh)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Unfriend") %>% 
  select(ConfigUnfriendThresh, OutdegreeSD) %>% 
  ggplot(aes(x = ConfigUnfriendThresh, y = OutdegreeSD)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigUnfriendThresh)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Unfriend") %>% 
  select(ConfigUnfriendThresh, OutdegreeMean) %>% 
  ggplot(aes(x = ConfigUnfriendThresh, y = OutdegreeMean)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigUnfriendThresh)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Unfriend") %>% 
  select(ConfigUnfriendThresh, OutdegreeMean) %>% 
  ggplot(aes(x = ConfigUnfriendThresh, y = OutdegreeMean)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigUnfriendThresh)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Unfriend") %>% 
  select(ConfigUnfriendThresh, IndegreeSD) %>% 
  ggplot(aes(x = ConfigUnfriendThresh, y = IndegreeSD)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigUnfriendThresh)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Unfriend") %>% 
  select(ConfigUnfriendThresh, IndegreeMean) %>% 
  ggplot(aes(x = ConfigUnfriendThresh, y = IndegreeMean)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigUnfriendThresh)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Unfriend") %>% 
  select(ConfigUnfriendThresh, SupernodeCentrality) %>% 
  ggplot(aes(x = ConfigUnfriendThresh, y = SupernodeCentrality)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigUnfriendThresh)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Netsize") %>% 
  select(ConfigAgentCount, SupernodeOpinion) %>% 
  ggplot(aes(x = ConfigAgentCount, y = SupernodeOpinion)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigAgentCount)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Unfriend") %>% 
  select(ConfigUnfriendThresh, ClustCoeff) %>% 
  ggplot(aes(x = ConfigUnfriendThresh, y = ClustCoeff)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigUnfriendThresh)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Unfriend") %>% 
  select(ConfigUnfriendThresh, Densities) %>% 
  ggplot(aes(x = ConfigUnfriendThresh, y = Densities)) +
  geom_jitter(alpha = 0.3, width = 0.2) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigUnfriendThresh)) +
  theme_bw() +
  theme(legend.position = "none")

results %>% 
  filter(BatchName == "Unfriend") %>% 
  select(ConfigUnfriendThresh, CommunityCount, ConnectedComponents) %>% 
  mutate(CommunityCountClean = CommunityCount - ConnectedComponents + 1) %>% 
  ggplot(aes(x = ConfigUnfriendThresh, y = CommunityCountClean)) +
  geom_jitter(alpha = 0.3, width = 0.2, height = 0.05) +
  geom_violin(alpha = 0.1, fill = "black") +
  geom_boxplot(alpha = 0.5, aes(fill = ConfigUnfriendThresh)) +
  theme_bw() +
  theme(legend.position = "none") +
  labs(
    x = "Configuration", 
    y = "Number of Communities (Label Propagation)"
  )

```


```{r}

results

```

